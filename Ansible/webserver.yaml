---
- hosts: webservers
  remote_user: root
  tasks:
   - name: registration to RHSM
     redhat_subscription:
       state: present
       username: "{{ rhsm_username }}"
       password: "{{ rhsm_password }}"
       pool_ids: "{{ rhsm_poolid }} "
   - name: Disable all repositories except rhel-8-server-rpms
     rhsm_repository:
       name: rhel-8-server-rpms
       purge: True
   - name: install httpd 
     yum:
       name: httpd
       state: present
   - name: enable service httpd
     service:
       name: httpd
       enabled: yes
       state: started
